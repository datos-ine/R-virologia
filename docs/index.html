<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="es" xml:lang="es"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Christian Ballejo">

<title>Introducción al lenguaje R + RStudio</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-dfb324f25d9b1687192fa8be62ac8f9c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Sin resultados",
    "search-matching-documents-text": "documentos encontrados",
    "search-copy-link-title": "Copiar el enlace en la búsqueda",
    "search-hide-matches-text": "Ocultar resultados adicionales",
    "search-more-match-text": "resultado adicional en este documento",
    "search-more-matches-text": "resultados adicionales en este documento",
    "search-clear-button-title": "Borrar",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancelar",
    "search-submit-button-title": "Enviar",
    "search-label": "Buscar"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./index.html">Fundamentos</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Alternar barra lateral" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Buscar" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/logos_ine.svg" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Buscar"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Fundamentos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidad1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 1: Introducción al lenguaje R</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidad2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 2: Procesamiento de datos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidad3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 3: Exploración, diagnóstico y limpieza de datos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidad4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 4: Tratamiento de datos específicos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidad5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 5: Estadísticos, operaciones múltiples y resúmenes</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidad6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 6: Inferencia estadística</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidad7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 7: Visualización de datos</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unidad8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Unidad 8: Comunicar con Quarto</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./extra.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Extra: Control de flujo y funciones</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Introducción al lenguaje R + RStudio</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Autor/a</div>
    <div class="quarto-title-meta-contents">
             <p>Christian Ballejo </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><strong>I. ORIENTACIONES GENERALES</strong></p>
<p>Fortalecimiento de capacidades del <em>Departamento de Epidemiología e Información Estratégica</em> del <strong>Hospital Hospital de Alta Complejidad El Calafate-SAMIC</strong>.</p>
<p><strong>II. ELEMENTOS DEL DISEÑO</strong></p>
<p>Nombre de la actividad: <strong>Introducción al lenguaje R aplicado a sistemas y servicios de salud</strong></p>
<p><strong>2. Fundamentación</strong></p>
<p>El Departamento de Epidemiología e Información Estratégica en Salud del Hospital Hospital de Alta Complejidad El Calafate-SAMIC (DEIES) trabaja procesando datos provenientes de diferentes fuentes digitales con el fin de resumir la información y presentarla en informes técnicos que faciliten la toma de decisiones.</p>
<p>El adecuado manejo de los sistemas de información requiere de recursos humanos calificados en el procesamiento y análisis de datos, capaces de identificar necesidades y problemas relevantes en la materia, y de lidiar con la complejidad creciente de los sistemas de información en salud. A su vez, es necesario dar respuesta a la demanda global de actualización en el análisis de datos, en paralelo a los adelantos tecnológicos y a la modernización de los procesos de trabajo.</p>
<p>Actualmente es necesario dotar con estas competencias a los integrantes del DEIES, estandarizar sus procesos de trabajo aumentando su eficiencia, facilitar el intercambio de información útil y su visualización ante requerimientos externos al departamento, y mantener organizadamente el cúmulo de datos que posee. También aplicar herramientas modernas como Quarto para la elaboración de informes técnicos y la creación de presentaciones gráficas interactivas en formato HTML, útiles para la construcción de salas de situación de salud, tanto coyunturales como de tendencias, así como también representar visualmente indicadores epidemiológicos con precisión y claridad, identificar tendencias críticas en salud pública de forma oportuna y optimizar el flujo de trabajo mediante procesos reproducibles y automatizados.</p>
<p>La adopción de software gratuito y de código abierto como el lenguaje R y Quarto, un sistema de publicación técnica de código abierto, ofrece una solución moderna y eficiente para abordar las necesidades mencionadas. Estas herramientas permiten el tratamiento y manipulación de datos con alta reproducibilidad, una capacidad estadística avanzada y una forma de publicación versátil y adaptable a diversos contextos</p>
<p><strong>3. Contribución esperada</strong></p>
<p>Mejora en la estandarización de procesos de limpieza, procesamiento y análisis de las bases de datos generando así un flujo de intercambio de información dinámico y de calidad entre los y las agentes del DEIES , permitiendo la reproducibilidad y mejora de todos los procesos. Producción de informes técnicos, documentos estáticos y tableros dinámicos con información epidemiológica del Hospital</p>
<p><strong>4. Perfil del participante y requisitos</strong></p>
<p>Perfil del participante: Integrantes del DEIES que se desempeñen en áreas vinculadas al análisis de datos y que deseen adquirir conocimientos para el procesamiento y análisis de datos con R/ RStudio.</p>
<p>Requisitos Obligatorios: competencias intermedias en gestión de archivos y software en sistema operativo Windows. Utilización básica de Microsoft Excel. Conocimientos básicos de estadística descriptiva.</p>
<p>Deseables: conocimientos básicos-intermedios de bases de datos y de lectura de idioma inglés. Equipamiento necesario: Se recomienda contar con computadoras que tengan al menos procesadores I5, 8GB de Memoria RAM o superior y sistema operativo Windows 10/11 con conexión a internet, micrófono y parlantes para la realización de los sincrónicos y prácticas del curso.</p>
<p><strong>5. Objetivos</strong></p>
<p>Se espera que al finalizar este curso los participantes puedan:</p>
<ul>
<li><p>Comprender los fundamentos del lenguaje R</p></li>
<li><p>Utilizar adecuadamente las herramientas de RStudio</p></li>
<li><p>Importar y exportar bases de datos de diferentes formatos</p></li>
<li><p>Entender y aplicar código de R base, tidyverse y otros paquetes específcos.</p></li>
<li><p>Realizar análisis descriptivo utilizando funciones estadísticas</p></li>
<li><p>Procesar y transformar datos utilizando funciones específicas</p></li>
<li><p>Depurar, ordenar y unir tablas de datos.</p></li>
<li><p>Realizar gráficos descriptivos</p></li>
<li><p>Producir informes y tableros mediante Quarto (HTML, Word, etc)</p></li>
</ul>
<p><strong>6. Contenidos</strong></p>
<p><strong>Unidad 1: Instalación e introducción al lenguaje R</strong></p>
<p>1.1 Descarga e instalación de R, Rtools y RStudio</p>
<p>1.2 Introducción al lenguaje R: Scripts. Objetos. Funciones y argumentos. Librerías y dependencias. Tipos de datos. Estructuras de datos. Asignación. Errores y advertencias. Operadores. Tuberías. Filosofía tidyverse.</p>
<p>1.3 Rstudio: Característica del entorno de desarrollo integrado. Proyectos. Consola. Memoria. Historial. Ayuda. Paquetes. Atajos de teclado</p>
<p>1.4 Sintaxis en R. Scripts. Documentación. Hoja de estilo del lenguaje. Buenas prácticas</p>
<p>1.5 Lectura de datos. Texto plano, Excel y otros formatos específicos.</p>
<p><strong>Unidad 2: Procesamiento de datos</strong></p>
<p>2.1 Gestión de datos con tidyverse. Paquete dplyr.</p>
<p>2.2 Uniones de tablas de datos. Familia de join’s y bind’s</p>
<p>2.3 Datos “tidy” y “no-tidy”. Pivoteos. Paquete tidyr.</p>
<p><strong>Unidad 3: Exploración, diagnóstico y limpieza de datos</strong></p>
<p>3.1 Exploración de tipos de datos y diagnóstico con paquetes skimr y dlookr</p>
<p>3.2 Manejo de duplicados. Limpieza de datos</p>
<p>3.3 Diagnóstico de valores perdidos (NA). Paquete naniar</p>
<p>3.4 Exportación de datos limpios en diferentes formatos.</p>
<p><strong>Unidad 4: Tratamiento de datos específicos</strong></p>
<p>4.1 Variables de tiempo. Librería Lubridate.</p>
<p>4.2 Cadenas de caracteres y factores. Paquete stringr y forcats</p>
<p><strong>Unidad 5: Estadísticos, operaciones múltiples y resúmenes</strong></p>
<p>5.1 Cálculos: Proporciones, razones y tasas.</p>
<p>5.2 Resumen estadístico. Medidas de tendencia central, posición y dispersión.</p>
<p>5.3 Cálculos masivos. Función across() y rowwise()</p>
<p>5.4 Paquete rstatix y gtsummary.</p>
<p><strong>Unidad 6: Visualización de datos</strong></p>
<p>6.1 Gramática de gráficos con ggplot2. Gráficos estadísticos.</p>
<p>6.2 Capas geométricas de líneas, puntos, barras, histogramas y boxplots. Facetas</p>
<p>6.3 Pirámides poblacionales. Curvas epidémicas y corredores endémicos.</p>
<p>6.4 Exportación en diferentes formatos (raster y vectorial)</p>
<p><strong>Unidad 7: Control de flujo y funciones</strong></p>
<p>7.1 Bucles y condicionales</p>
<p>7.2 Creación de funciones</p>
<p><strong>Unidad 8: Comunicar con Quarto</strong></p>
<p>8.1 Quarto. Paquete tinytext.</p>
<p>8.2 Lenguaje de marcas markdown. Cabeceras YAML. Paquete flextable. Personalización estética</p>
<p>8.3 Documentos estáticos PDF y Word</p>
<p>8.4 Páginas HTML y tableros dinámicos</p>
<p><strong>7. Estrategias metodológicas y recursos didácticos</strong></p>
<p>Realización de trabajos prácticos (TP) semanales. Se utilizará de apoyo un aula virtual alojada dentro de la plataforma educativa moodle de ANLIS.</p>
<p>Actividades de desarrollo: cada semana se abordará una unidad, en un primer encuentro sincrónico el docente explicará los puntos temáticos, en un segundo encuentro se llevará a cabo la práctica relacionada. Las clases teóricas y prácticas serán virtuales, de una duración aproximada máxima de dos horas, mediante Webex, que luego quedarán disponibles en la plataforma de aprendizaje. Cada unidad se acompañará de materiales de apoyo, prácticas y recursos en el aula virtual. Las actividades serán monitoreadas por el docente a través de la plataforma educativa, a la vez que ofrecerá apoyo a través de un foro de consultas.</p>
<p><strong>8. Descripción de la modalidad</strong></p>
<p>Virtual</p>
<p><strong>9. Bibliografía para el participante</strong></p>
<p>Hadley Wickham, Mine Çetinkaya-Rundel, and Garrett Grolemund (2023) R for Data Science (2e). Disponible en https://r4ds.hadley.nz/</p>
<p>Hadley Wickham, Danielle Navarro, and Thomas Lin Pedersen (2023) ggplot2: Elegant graphics for data analysis (3e). https://ggplot2-book.org/</p>
<p>Tipos de gráficos https://www.data-to-viz.com/</p>
<p>Neale Batra y otros (2022) R para epidemiología aplicada y salud pública. https://epirhandbook.com/es/index.html</p>
<p><strong>10. Evaluación de los aprendizajes</strong></p>
<p>Se requerirá la entrega y aprobación de 7 trabajos prácticos. Los trabajos prácticos evaluativos parciales serán individuales y estarán relacionados a las unidades 2 a la 8. Se publicará una consigna en el aula virtual con puntos a resolver mediante código en lenguaje R que deberán entregar a la semana siguiente. La evaluación final consistirá en un trabajo práctico grupal que consistirá en procesar datos crudos y obtener un producto final con una serie de resultados a visualizar con tablas y gráficos. Los pasos a considerar en el trabajo práctico final son: Creación de un proyecto RStudio Lectura de datos Exploración y diagnóstico. Formateo y depuración de datos crudos a datos limpios Obtención de resúmenes descriptivos y creación de nuevas variables Elaboración de tablas y gráficos Creación de documento o tablero dinámico</p>
<p><strong>11. Instrumentos para la evaluación</strong></p>
<p>Instrumentos para la evaluación de los aprendizajes Registro de Asistencia de las/os participantes.</p>
<p>Grilla para la corrección de TPs. Grilla para la corrección del TP grupal final Instrumentos para la evaluación de la actividad</p>
<p>Encuesta de satisfacción de la actividad de carácter anónimo</p>
<p><strong>12. Perfil del instructor</strong></p>
<p>Especialista en Sistemas / Datos con orientación a la epidemiología y salud pública</p>
<p><strong>13. Requisitos de asistencia y aprobación</strong></p>
<p>Para la aprobación se requiere asistencia en el 80% de las clases sincrónicas (teóricas y prácticas).</p>
<p>Realización de la totalidad de TP´s planteados</p>
<p><strong>14. Duración en horas</strong></p>
<p>El curso tendrá una duración total de 76 horas distribuidas a lo largo de 10 semanas.</p>
<p><strong>15. Detalle de la duración</strong></p>
<p>32 horas sincrónicas distribuidas en 16 encuentros de 2 horas cada uno (2 veces por semana durante 8 semanas) y 44 horas asincrónicas, calculadas 4 horas por semana durante las 8 semanas del curso para la lectura del material (1 hora), la realización de los trabajos prácticos (3 horas) y la elaboración del TP integrador final (12 horas)</p>
<p><strong>16. Lugar</strong></p>
<p>Las clases virtuales se realizarán a través de la plataforma Webex. Se contará con un campus virtual para la publicación de material y recursos, consultas y entrega y corrección de TPs: http://capacitacion.anlis.gob.ar/</p>
<p><strong>17. Cronograma tentativo</strong></p>
<p>Comienzo jueves 3 de abril y finalización viernes 6 de junio de 2025.</p>
<p>Encuentros sincrónicos teóricos: los jueves 3, 10, 17, 24 de abril, 1 de mayo (se sube al aula grabado), 8, 15, 22 de mayo de 10 a 12 hs.</p>
<p>Encuentros sincrónicos prácticos: los viernes 4, 11, 18, 25 de abril, 2, 9, 16, 23 de mayo de 9 a 11 hs.</p>
<p>Práctico integrador final: del 23 de mayo al 6 de junio de 2025.</p>



<a onclick="window.scrollTo(0, 0); return false;" role="button" id="quarto-back-to-top"><i class="bi bi-arrow-up"></i> Volver arriba</a></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copiado");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copiado");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>